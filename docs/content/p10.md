#  Semana 10 - Selectores del DOM en JavaScript

## Introducción a los Selectores

Los **selectores** son métodos que nos permiten encontrar y obtener elementos específicos del DOM. Es como tener un sistema de búsqueda súper poderoso para tu página web. Imagina que tu página web es una biblioteca gigante y los selectores son diferentes formas de encontrar exactamente el libro que necesitas.

## Métodos de Selección Principales

### 1. getElementById() - Buscar por ID

Este es el método más específico y rápido. Cada ID debe ser único en la página.

```html
<div id="miContenedor">Contenido principal</div>
<button id="botonPrincipal">Hacer clic</button>
<p id="mensaje">Este es un mensaje</p>
```

```javascript
// Seleccionar por ID
const contenedor = document.getElementById('miContenedor');
const boton = document.getElementById('botonPrincipal');
const mensaje = document.getElementById('mensaje');

console.log(contenedor.textContent); // "Contenido principal"
console.log(boton.textContent); // "Hacer clic"
console.log(mensaje.textContent); // "Este es un mensaje"

// Verificar si el elemento existe
if (contenedor) {
    console.log('Contenedor encontrado!');
} else {
    console.log('Contenedor no encontrado');
}
```

### 2. getElementsByClassName() - Buscar por Clase

Devuelve una **HTMLCollection** con todos los elementos que tienen la clase especificada.

```html
<div class="tarjeta">Tarjeta 1</div>
<div class="tarjeta destacada">Tarjeta 2</div>
<p class="tarjeta">Párrafo con clase tarjeta</p>
<span class="destacada">Texto destacado</span>
```

```javascript
// Seleccionar por clase
const tarjetas = document.getElementsByClassName('tarjeta');
const destacadas = document.getElementsByClassName('destacada');

console.log('Número de tarjetas:', tarjetas.length); // 3
console.log('Número de destacadas:', destacadas.length); // 2

// Iterar sobre los elementos
for (let i = 0; i < tarjetas.length; i++) {
    console.log(`Tarjeta ${i + 1}:`, tarjetas[i].textContent);
}

// Convertir a array para usar métodos modernos
const tarjetasArray = Array.from(tarjetas);
tarjetasArray.forEach((tarjeta, indice) => {
    console.log(`Tarjeta ${indice + 1}:`, tarjeta.textContent);
});
```

### 3. getElementsByTagName() - Buscar por Etiqueta

Devuelve todos los elementos de un tipo específico de etiqueta HTML.

```html
<h1>Título Principal</h1>
<h2>Subtítulo 1</h2>
<h2>Subtítulo 2</h2>
<p>Primer párrafo</p>
<p>Segundo párrafo</p>
<p>Tercer párrafo</p>
```

```javascript
// Seleccionar por etiqueta
const titulos = document.getElementsByTagName('h2');
const parrafos = document.getElementsByTagName('p');
const todosLosElementos = document.getElementsByTagName('*'); // Todos los elementos

console.log('Subtítulos encontrados:', titulos.length); // 2
console.log('Párrafos encontrados:', parrafos.length); // 3
console.log('Total de elementos:', todosLosElementos.length);

// Ejemplo práctico: cambiar el estilo de todos los párrafos
for (let parrafo of parrafos) {
    parrafo.style.color = 'blue';
    parrafo.style.fontSize = '16px';
}
```

### 4. querySelector() - Selector CSS (Uno)

Este es el método más moderno y flexible. Usa la misma sintaxis que CSS y devuelve el **primer elemento** que coincida.

```html
<div class="contenedor">
    <h1 id="titulo">Mi Título</h1>
    <p class="descripcion">Primera descripción</p>
    <p class="descripcion destacada">Segunda descripción</p>
    <ul>
        <li>Elemento 1</li>
        <li class="especial">Elemento 2</li>
        <li>Elemento 3</li>
    </ul>
</div>
```

```javascript
// Selectores básicos
const titulo = document.querySelector('#titulo'); // Por ID
const primerParrafo = document.querySelector('.descripcion'); // Por clase
const contenedor = document.querySelector('div'); // Por etiqueta

// Selectores combinados
const parrafoDestacado = document.querySelector('.descripcion.destacada'); // Múltiples clases
const liEspecial = document.querySelector('li.especial'); // Etiqueta + clase
const primerLi = document.querySelector('ul li'); // Descendiente
const parrafoEnContenedor = document.querySelector('.contenedor p'); // Descendiente específico

// Selectores de atributos
const elementoConId = document.querySelector('[id]'); // Cualquier elemento con ID
const elementoConClase = document.querySelector('[class="especial"]'); // Atributo específico

// Pseudo-selectores
const primerHijo = document.querySelector('li:first-child');
const ultimoHijo = document.querySelector('li:last-child');
const segundoHijo = document.querySelector('li:nth-child(2)');

console.log('Título:', titulo?.textContent);
console.log('Primer párrafo:', primerParrafo?.textContent);
console.log('Párrafo destacado:', parrafoDestacado?.textContent);
```

### 5. querySelectorAll() - Selector CSS (Todos)

Igual que `querySelector()` pero devuelve **todos los elementos** que coincidan en un NodeList.

```javascript
// Seleccionar múltiples elementos
const todasLasDescripciones = document.querySelectorAll('.descripcion');
const todosLosLi = document.querySelectorAll('li');
const elementosDestacados = document.querySelectorAll('.destacada');

console.log('Descripciones encontradas:', todasLasDescripciones.length);
console.log('Items de lista:', todosLosLi.length);

// Iterar con forEach (NodeList tiene este método)
todasLasDescripciones.forEach((descripcion, indice) => {
    console.log(`Descripción ${indice + 1}:`, descripcion.textContent);
});

// Convertir a array para más métodos
const liArray = [...todosLosLi];
const textos = liArray.map(li => li.textContent);
console.log('Textos de los li:', textos);
```

## Selectores CSS Avanzados

### Selectores de Relación

```html
<div class="padre">
    <h2>Título</h2>
    <p>Párrafo directo</p>
    <div class="hijo">
        <p>Párrafo anidado</p>
        <span>Texto en span</span>
    </div>
    <p>Otro párrafo directo</p>
</div>
```

```javascript
// Descendiente (espacio): cualquier nivel de anidación
const todosLosP = document.querySelectorAll('.padre p');
console.log('Párrafos descendientes:', todosLosP.length); // 3

// Hijo directo (>): solo hijos inmediatos
const hijosDirectos = document.querySelectorAll('.padre > p');
console.log('Párrafos hijos directos:', hijosDirectos.length); // 2

// Hermano adyacente (+): el siguiente hermano inmediato
const hermanoAdyacente = document.querySelector('h2 + p');
console.log('Hermano adyacente:', hermanoAdyacente?.textContent);

// Hermanos generales (~): todos los hermanos siguientes
const hermanosGenerales = document.querySelectorAll('h2 ~ p');
console.log('Hermanos generales:', hermanosGenerales.length);
```

### Selectores de Atributos

```html
<input type="text" name="usuario" placeholder="Nombre de usuario">
<input type="email" name="correo" required>
<input type="password" name="clave">
<button type="submit" disabled>Enviar</button>
<a href="https://ejemplo.com" target="_blank">Enlace externo</a>
<img src="imagen.jpg" alt="Descripción" data-categoria="fotos">
```

```javascript
// Atributo existe
const elementosConPlaceholder = document.querySelectorAll('[placeholder]');
const elementosRequeridos = document.querySelectorAll('[required]');

// Atributo con valor específico
const inputTexto = document.querySelector('[type="text"]');
const inputEmail = document.querySelector('[type="email"]');

// Atributo que contiene valor
const enlacesExternos = document.querySelectorAll('[href*="https"]');
const imagenesJpg = document.querySelectorAll('[src$=".jpg"]');

// Atributo que empieza con valor
const elementosData = document.querySelectorAll('[class^="data-"]');

// Atributos personalizados (data-*)
const elementosConCategoria = document.querySelectorAll('[data-categoria]');
const fotosCategorias = document.querySelectorAll('[data-categoria="fotos"]');

console.log('Elementos con placeholder:', elementosConPlaceholder.length);
console.log('Elementos requeridos:', elementosRequeridos.length);
console.log('Enlaces externos:', enlacesExternos.length);
```

### Pseudo-selectores

```html
<ul class="lista">
    <li>Primer elemento</li>
    <li>Segundo elemento</li>
    <li>Tercer elemento</li>
    <li>Cuarto elemento</li>
    <li>Quinto elemento</li>
</ul>
```

```javascript
// Pseudo-selectores de posición
const primerElemento = document.querySelector('.lista li:first-child');
const ultimoElemento = document.querySelector('.lista li:last-child');
const tercerElemento = document.querySelector('.lista li:nth-child(3)');
const elementosPares = document.querySelectorAll('.lista li:nth-child(even)');
const elementosImpares = document.querySelectorAll('.lista li:nth-child(odd)');

// Pseudo-selectores de tipo
const primerLi = document.querySelector('li:first-of-type');
const ultimoLi = document.querySelector('li:last-of-type');

// Pseudo-selectores de estado
const elementosHabilitados = document.querySelectorAll('input:enabled');
const elementosDeshabilitados = document.querySelectorAll('input:disabled');
const elementosChecked = document.querySelectorAll('input:checked');

console.log('Primer elemento:', primerElemento?.textContent);
console.log('Último elemento:', ultimoElemento?.textContent);
console.log('Elementos pares:', elementosPares.length);
console.log('Elementos impares:', elementosImpares.length);
```

## Comparación de Métodos

### Rendimiento y Uso

```javascript
// Rendimiento (de más rápido a más lento)
// 1. getElementById() - Más rápido
const elemento1 = document.getElementById('miId');

// 2. getElementsByClassName() - Rápido
const elementos2 = document.getElementsByClassName('miClase');

// 3. getElementsByTagName() - Rápido
const elementos3 = document.getElementsByTagName('div');

// 4. querySelector() - Más lento pero más flexible
const elemento4 = document.querySelector('#miId');

// 5. querySelectorAll() - Más lento pero más flexible
const elementos5 = document.querySelectorAll('.miClase');
```

### Cuándo Usar Cada Método

```javascript
// ✅ Usar getElementById() cuando:
// - Necesitas un elemento específico por ID
// - Rendimiento es crítico
const header = document.getElementById('header');

// ✅ Usar getElementsByClassName() cuando:
// - Necesitas elementos por clase
// - Quieres una colección "viva" que se actualice automáticamente
const botones = document.getElementsByClassName('btn');

// ✅ Usar querySelector() cuando:
// - Necesitas selectores CSS complejos
// - Solo necesitas el primer elemento
const primerBotonActivo = document.querySelector('.btn.activo');

// ✅ Usar querySelectorAll() cuando:
// - Necesitas selectores CSS complejos
// - Necesitas todos los elementos que coincidan
const todosLosBotonesActivos = document.querySelectorAll('.btn.activo');
```

## Ejemplos Prácticos

### Ejemplo 1: Sistema de Navegación

```html
<nav class="navegacion">
    <ul>
        <li><a href="#inicio" class="enlace activo">Inicio</a></li>
        <li><a href="#servicios" class="enlace">Servicios</a></li>
        <li><a href="#contacto" class="enlace">Contacto</a></li>
    </ul>
</nav>
```

```javascript
function configurarNavegacion() {
    // Seleccionar todos los enlaces de navegación
    const enlaces = document.querySelectorAll('.navegacion .enlace');
    const enlaceActivo = document.querySelector('.navegacion .enlace.activo');
    
    console.log('Enlaces encontrados:', enlaces.length);
    console.log('Enlace activo:', enlaceActivo?.textContent);
    
    // Agregar evento a cada enlace
    enlaces.forEach(enlace => {
        enlace.addEventListener('click', function(e) {
            e.preventDefault();
            
            // Remover clase activo de todos
            enlaces.forEach(e => e.classList.remove('activo'));
            
            // Agregar clase activo al clickeado
            this.classList.add('activo');
            
            console.log('Navegando a:', this.textContent);
        });
    });
}

configurarNavegacion();
```

### Ejemplo 2: Validador de Formulario

```html
<form id="miFormulario">
    <input type="text" name="nombre" required placeholder="Nombre">
    <input type="email" name="email" required placeholder="Email">
    <input type="password" name="password" required placeholder="Contraseña">
    <button type="submit">Enviar</button>
</form>
```

```javascript
function validarFormulario() {
    const formulario = document.getElementById('miFormulario');
    const camposRequeridos = document.querySelectorAll('#miFormulario [required]');
    const botonEnviar = document.querySelector('#miFormulario button[type="submit"]');
    
    function verificarCampos() {
        let todosCompletos = true;
        
        camposRequeridos.forEach(campo => {
            if (!campo.value.trim()) {
                todosCompletos = false;
                campo.style.borderColor = 'red';
            } else {
                campo.style.borderColor = 'green';
            }
        });
        
        botonEnviar.disabled = !todosCompletos;
        return todosCompletos;
    }
    
    // Verificar en tiempo real
    camposRequeridos.forEach(campo => {
        campo.addEventListener('input', verificarCampos);
    });
    
    // Verificar al enviar
    formulario.addEventListener('submit', function(e) {
        if (!verificarCampos()) {
            e.preventDefault();
            alert('Por favor, completa todos los campos requeridos');
        }
    });
}

validarFormulario();
```

### Ejemplo 3: Galería de Imágenes

```html
<div class="galeria">
    <img src="img1.jpg" alt="Imagen 1" class="miniatura" data-grande="img1-grande.jpg">
    <img src="img2.jpg" alt="Imagen 2" class="miniatura" data-grande="img2-grande.jpg">
    <img src="img3.jpg" alt="Imagen 3" class="miniatura" data-grande="img3-grande.jpg">
</div>
<div id="modal" class="modal oculto">
    <img id="imagenGrande" src="" alt="">
    <button id="cerrarModal">×</button>
</div>
```

```javascript
function configurarGaleria() {
    const miniaturas = document.querySelectorAll('.galeria .miniatura');
    const modal = document.getElementById('modal');
    const imagenGrande = document.getElementById('imagenGrande');
    const botonCerrar = document.getElementById('cerrarModal');
    
    // Configurar click en miniaturas
    miniaturas.forEach(miniatura => {
        miniatura.addEventListener('click', function() {
            const srcGrande = this.getAttribute('data-grande');
            const alt = this.getAttribute('alt');
            
            imagenGrande.src = srcGrande;
            imagenGrande.alt = alt;
            modal.classList.remove('oculto');
        });
    });
    
    // Cerrar modal
    botonCerrar.addEventListener('click', function() {
        modal.classList.add('oculto');
    });
    
    // Cerrar con ESC
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && !modal.classList.contains('oculto')) {
            modal.classList.add('oculto');
        }
    });
}

configurarGaleria();
```

## Ejercicios Prácticos

### Ejercicio 1: Contador de Elementos

```javascript
function contarElementos() {
    const contadores = {
        totalElementos: document.querySelectorAll('*').length,
        divs: document.getElementsByTagName('div').length,
        parrafos: document.getElementsByTagName('p').length,
        imagenes: document.getElementsByTagName('img').length,
        enlaces: document.getElementsByTagName('a').length,
        elementosConId: document.querySelectorAll('[id]').length,
        elementosConClase: document.querySelectorAll('[class]').length
    };
    
    console.table(contadores);
    return contadores;
}

contarElementos();
```

### Ejercicio 2: Buscador de Elementos

```javascript
function buscarElementos(selector) {
    try {
        const elementos = document.querySelectorAll(selector);
        
        console.log(`Selector: "${selector}"`);
        console.log(`Elementos encontrados: ${elementos.length}`);
        
        elementos.forEach((elemento, indice) => {
            console.log(`${indice + 1}. ${elemento.tagName}${elemento.id ? '#' + elemento.id : ''}${elemento.className ? '.' + elemento.className.replace(/ /g, '.') : ''}`);
        });
        
        return elementos;
    } catch (error) {
        console.error('Selector inválido:', error.message);
        return null;
    }
}

// Ejemplos de uso
buscarElementos('div');
buscarElementos('.mi-clase');
buscarElementos('#mi-id');
buscarElementos('div.clase p');
```

### Ejercicio 3: Analizador de Selectores

```javascript
function analizarSelectores() {
    const selectores = [
        'div',
        '.clase',
        '#id',
        'div.clase',
        'div > p',
        'div p',
        'input[type="text"]',
        'li:first-child',
        'p:nth-child(2n)',
        '[data-*]'
    ];
    
    selectores.forEach(selector => {
        try {
            const elementos = document.querySelectorAll(selector);
            console.log(`${selector.padEnd(20)} → ${elementos.length} elementos`);
        } catch (error) {
            console.log(`${selector.padEnd(20)} → Error: ${error.message}`);
        }
    });
}

analizarSelectores();
```

## Mejores Prácticas

### 1. Verificar Existencia

```javascript
// ✅ Siempre verificar si el elemento existe
const elemento = document.getElementById('miElemento');
if (elemento) {
    elemento.style.color = 'red';
} else {
    console.warn('Elemento no encontrado');
}

// ✅ Usar optional chaining (ES2020)
const texto = document.querySelector('.mi-clase')?.textContent;
```

### 2. Cachear Selectores

```javascript
// ❌ Malo: seleccionar repetidamente
function malaFuncion() {
    document.getElementById('boton').addEventListener('click', () => {
        document.getElementById('mensaje').textContent = 'Clickeado';
        document.getElementById('contador').textContent = '1';
    });
}

// ✅ Bueno: cachear selectores
function buenaFuncion() {
    const boton = document.getElementById('boton');
    const mensaje = document.getElementById('mensaje');
    const contador = document.getElementById('contador');
    
    if (boton && mensaje && contador) {
        boton.addEventListener('click', () => {
            mensaje.textContent = 'Clickeado';
            contador.textContent = '1';
        });
    }
}
```

### 3. Usar el Selector Más Específico

```javascript
// ✅ Específico y rápido
const elemento = document.getElementById('miId');

// ❌ Menos eficiente
const elemento = document.querySelector('#miId');

// ✅ Para selectores complejos, usar querySelector
const elemento = document.querySelector('.contenedor > .hijo:first-child');
```

## Resumen

En esta semana hemos aprendido:

1. **Métodos básicos**: `getElementById()`, `getElementsByClassName()`, `getElementsByTagName()`
2. **Métodos modernos**: `querySelector()` y `querySelectorAll()`
3. **Selectores CSS**: Básicos, avanzados, de relación, de atributos y pseudo-selectores
4. **Mejores prácticas**: Verificación, cacheo y eficiencia
5. **Ejemplos prácticos**: Navegación, formularios y galerías

Los selectores son fundamentales para la manipulación del DOM. En la próxima semana aprenderemos cómo modificar los elementos que hemos seleccionado.

!!! tip "Consejo"
    Practica diferentes selectores en la consola del navegador. Usa `document.querySelectorAll('tu-selector')` para experimentar y ver qué elementos seleccionas.


